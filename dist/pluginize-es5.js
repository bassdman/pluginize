var pluginizeWrapper=function(n){"use strict";function e(n){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function t(n,e,t,r,o,i,a){try{var u=n[i](a),c=u.value}catch(n){return void t(n)}u.done?e(c):Promise.resolve(c).then(r,o)}function r(n){return function(){var e=this,r=arguments;return new Promise((function(o,i){var a=n.apply(e,r);function u(n){t(a,o,i,u,c,"next",n)}function c(n){t(a,o,i,u,c,"throw",n)}u(void 0)}))}}function o(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function i(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function a(n,e,t){return e&&i(n.prototype,e),t&&i(n,t),n}function u(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),e&&l(n,e)}function c(n){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(n)}function l(n,e){return(l=Object.setPrototypeOf||function(n,e){return n.__proto__=e,n})(n,e)}function s(n,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(n):e}function f(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(n){return!1}}();return function(){var t,r=c(n);if(e){var o=c(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return s(this,t)}}function g(n){return function(n){if(Array.isArray(n))return y(n)}(n)||function(n){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(n))return Array.from(n)}(n)||p(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(n,e){if(n){if("string"==typeof n)return y(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?y(n,e):void 0}}function y(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function h(n,e){var t;if("undefined"==typeof Symbol||null==n[Symbol.iterator]){if(Array.isArray(n)||(t=p(n))||e&&n&&"number"==typeof n.length){t&&(n=t);var r=0,o=function(){};return{s:o,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(n){throw n},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){t=n[Symbol.iterator]()},n:function(){var n=t.next();return a=n.done,n},e:function(n){u=!0,i=n},f:function(){try{a||null==t.return||t.return()}finally{if(u)throw i}}}}var d="production";function b(n,e){if("development"==d)throw e;throw new Error(n)}function v(n,e,t){n&&b(e,t)}function k(n){d=n}var m={name:"DefaultPlugins",plugins:[new function(){var n=["name","hooks","init","allowKeys","desactivateKeyCheck","plugins","debug","changeConfig"],e=!1;return{name:"ValidateConfigPlugin",hooks:{initPlugin:function(t,r){t.allowKeys&&n.push.apply(n,g(t.allowKeys)),t.desactivateKeyCheck&&(e=t.desactivateKeyCheck)},pluginsInitialized:function(t){if(!e){var r,o=h(t.plugins);try{for(o.s();!(r=o.n()).done;)for(var i=r.value,a=0,u=Object.keys(i);a<u.length;a++){var c=u[a];n.includes(c)||b('Config attribute "'.concat(c,'" is used but not allowed. Allowed are ').concat(n.join(", "),". \n                            You want to disable this proove? set desactivateKeyCheck:true.\n                            You want to allow another config attributes? Add allowKeys:['yourkeyname']."),"config.invalidKey")}}catch(n){o.e(n)}finally{o.f()}}}},init:function(){return{desactivateKeyCheck:function(){e=!0}}}}},new function(n){return{name:"InitHooksPlugin",allowKeys:["addHooks","hooks"],hooks:{initPlugin:function(n,t){if(n.addHooks){v(Array.isArray(n.addHooks)||"object"!=e(n.addHooks),'Error in plugin "'.concat(n.name,'": config.addHooks must be an object but is a ').concat(e(n.addHooks)),"config.addHooks.wrongtype");for(var r=0,o=Object.keys(n.addHooks);r<o.length;r++){var i=o[r];t.hooks[i]=n.addHooks[i]}}if(n.hooks){v(Array.isArray(n.hooks)||"object"!=e(n.hooks),'Error in plugin "'.concat(n.name,'": config.hooks must be an object but is a ').concat(e(n.hooks)),"config.hooks.wrongtype");for(var a=0,u=Object.keys(n.hooks);a<u.length;a++){var c=u[a];v(!t.hooks[c],'There is no Hook named "'+c+'", declared in plugin '+n.name+' . Is it correctly written? If yes, initialize it first with config attribute "addHooks"',"config.hooks.notDefined"),t.hooks[c].tap(n.name,n.hooks[c])}}}},init:function(n,e){return e.config.hooks&&e.config.hooks.preInitPlugin&&e.hooks.preInitPlugin.tap("preInitPlugin",e.config.hooks.preInitPlugin),{addHooks:function(n){for(var t=0,r=Object.keys(n);t<r.length;t++){var o=r[t];e.hooks[o]=n[o]}},on:function(n,t,r){if(!e.hooks[n])throw new Error('Hook with name "'+n+'" does not exist. context.on(name, pluginname, fn) failed');return e.hooks[n].tap(t,r)}}}}},new function(){return{allowKeys:["return"],name:"ReturnPlugin",hooks:{initPlugin:function(n,e){n.return&&(e.return=n.return)}}}},new function(){var n={};return{allowKeys:["rename"],name:"RenamePlugin",hooks:{initPlugin:function(e,t){if(e.rename)for(var r,o,i=0,a=Object.keys(e.rename);i<a.length;i++)o=a[i],r=e.rename[o],n[o]=r},return:function(e){for(var t,r=0,o=Object.keys(n);r<o.length;r++)t=o[r],e[n[t]]=e[t],delete e[t]}}}},new function(){var n=[];return{allowKeys:["delete"],name:"DeletePlugin",hooks:{initPlugin:function(e,t){e.delete&&n.push.apply(n,g(e.delete))},return:function(e){var t,r=h(n);try{for(r.s();!(t=r.n()).done;){delete e[t.value]}}catch(n){r.e(n)}finally{r.f()}}}}}]},w=function(){function n(){o(this,n),this._listeners={}}return a(n,[{key:"tap",value:function(n,e){if(null==n)throw new Error("Hook.on(): should be on(name:string, listener:function) but name is undefined");if(null==e)throw new Error("Hook.on(): should be on(name:string, listener:function) but listener is undefined");this._listeners[n]=e}},{key:"off",value:function(n){if(null==n)throw new Error("Hook.off(): should be on(name:string, listener:function) but name is undefined");delete this._listeners[n]}},{key:"listeners",value:function(n){return n?this._listeners[n]:Object.values(this._listeners)}}]),n}(),x=function(n){u(t,n);var e=f(t);function t(){return o(this,t),e.apply(this,arguments)}return a(t,[{key:"call",value:function(n){var e,t=this.listeners(),r=h(t);try{for(r.s();!(e=r.n()).done;){var o=e.value;o.apply(void 0,arguments)}}catch(n){r.e(n)}finally{r.f()}}}]),t}(w),P=function(n){u(i,n);var e,t=f(i);function i(){return o(this,i),t.apply(this,arguments)}return a(i,[{key:"promise",value:(e=r(regeneratorRuntime.mark((function n(e){var t,r,o,i,a=arguments;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t=this.listeners(),r=h(t),n.prev=2,r.s();case 4:if((o=r.n()).done){n.next=10;break}return i=o.value,n.next=8,i.apply(void 0,a);case 8:n.next=4;break;case 10:n.next=15;break;case 12:n.prev=12,n.t0=n.catch(2),r.e(n.t0);case 15:return n.prev=15,r.f(),n.finish(15);case 18:case"end":return n.stop()}}),n,this,[[2,12,15,18]])}))),function(n){return e.apply(this,arguments)})}]),i}(w),C=function(n){u(t,n);var e=f(t);function t(){return o(this,t),e.apply(this,arguments)}return a(t,[{key:"call",value:function(n){var e,t=n,r=this.listeners(),o=h(r);try{for(o.s();!(e=o.n()).done;){var i=e.value;if(null==t)throw new Error("A listener in SyncWaterfallHook.trigger(context) returns null. This is not allowed. Did you forget returning sth in a listener?");t=i.apply(void 0,[t].concat(Array.prototype.slice.call(arguments)))}}catch(n){o.e(n)}finally{o.f()}return t}}]),t}(w),A=function(n){u(i,n);var e,t=f(i);function i(){return o(this,i),t.apply(this,arguments)}return a(i,[{key:"promise",value:(e=r(regeneratorRuntime.mark((function n(e){var t,r,o,i,a,u=arguments;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t=e,r=this.listeners(),o=h(r),n.prev=3,o.s();case 5:if((i=o.n()).done){n.next=12;break}return a=i.value,n.next=9,a.apply(void 0,[t].concat(Array.prototype.slice.call(u)));case 9:t=n.sent;case 10:n.next=5;break;case 12:n.next=17;break;case 14:n.prev=14,n.t0=n.catch(3),o.e(n.t0);case 17:return n.prev=17,o.f(),n.finish(17);case 20:return n.abrupt("return",t);case 21:case"end":return n.stop()}}),n,this,[[3,14,17,20]])}))),function(n){return e.apply(this,arguments)})}]),i}(w),j=function(n){u(t,n);var e=f(t);function t(){return o(this,t),e.apply(this,arguments)}return a(t,[{key:"call",value:function(n){var e,t=this.listeners(),r=h(t);try{for(r.s();!(e=r.n()).done;){var o=e.value,i=o.apply(void 0,arguments);if(!i)return}}catch(n){r.e(n)}finally{r.f()}}}]),t}(w),z=function(n){u(i,n);var e,t=f(i);function i(){return o(this,i),t.apply(this,arguments)}return a(i,[{key:"call",value:(e=r(regeneratorRuntime.mark((function n(e){var t,r,o,i,a=arguments;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t=this.listeners(),r=h(t),n.prev=2,r.s();case 4:if((o=r.n()).done){n.next=13;break}return i=o.value,n.next=8,i.apply(void 0,a);case 8:if(n.sent){n.next=11;break}return n.abrupt("return");case 11:n.next=4;break;case 13:n.next=18;break;case 15:n.prev=15,n.t0=n.catch(2),r.e(n.t0);case 18:return n.prev=18,r.f(),n.finish(18);case 21:case"end":return n.stop()}}),n,this,[[2,15,18,21]])}))),function(n){return e.apply(this,arguments)})}]),i}(w);function I(n){function t(n,e){return o.apply(this,arguments)}function o(){return(o=r(regeneratorRuntime.mark((function n(r,o){var i,a,u,c,l,s,f;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o.log('- Add plugin "'+r.name+'"'),n.next=3,o.hooks.preInitPlugin.promise(r,o);case 3:if(n.t0=n.sent,n.t0){n.next=6;break}n.t0=r;case 6:if(v(!(r=n.t0).name,"Plugin ".concat(JSON.stringify(r),' has no name. Please define a name by adding an attribute name:"pluginname" to your plugin.'),"plugin.noName"),v("function"==typeof r,"Plugin ".concat(r.name," is a function, but should be a configuration object. Did you forget calling it? (eg: PluginName())"),"plugin.isFunction"),v("object"!==e(r)||Array.isArray(r),"Plugin ".concat(r.name," should be a configuration of type object, but is typeof ").concat(e(r),"."),"plugin.wrongType"),o.plugins.push(r),!r.init){n.next=18;break}return v("function"!=typeof r.init,'Error in plugin "'.concat(r.name,'": config.init must be a function but is a ').concat(e(r.init)),"config.init.wrongtype"),o.log("- Execute init() function of plugin ".concat(r.name)),n.next=16,r.init(r,o);case 16:if((i=n.sent)&&!i._context&&"object"==e(i)&&!Array.isArray(i)){a=h(Object.keys(i)||{});try{for(a.s();!(u=a.n()).done;)c=u.value,o.log("- add "+c+" to global context."),o[c]=i[c]}catch(n){a.e(n)}finally{a.f()}}case 18:if(!r.hooks||!r.hooks.initPlugin){n.next=21;break}return n.next=21,o.hooks.initPlugin.tap(r.name,r.hooks.initPlugin);case 21:v(r.plugins&&!Array.isArray(r.plugins),'Error in plugin "'.concat(r.name,'": config.plugin must be an array but is an ').concat(e(r.plugins)),"config.plugin.wrongtype"),l=h(r.plugins||[]),n.prev=23,l.s();case 25:if((s=l.n()).done){n.next=31;break}return f=s.value,n.next=29,t(f,o);case 29:n.next=25;break;case 31:n.next=36;break;case 33:n.prev=33,n.t1=n.catch(23),l.e(n.t1);case 36:return n.prev=36,l.f(),n.finish(36);case 39:return n.abrupt("return",o);case 40:case"end":return n.stop()}}),n,null,[[23,33,36,39]])})))).apply(this,arguments)}return function(){var o=r(regeneratorRuntime.mark((function r(){var o,i,a,u,c,l,s,f,g=arguments;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=g.length>0&&void 0!==g[0]?g[0]:{},i={plugins:[],config:o,_context:!0,addPlugin:t,hooks:{return:new P(["context"]),preInitPlugin:new A(["config","context"]),pluginsInitialized:new P(["context"]),initPlugin:new P(["plugin","context"])},log:function(){var n;o.debug&&(n=console).log.apply(n,arguments)}},!n.changeConfig){r.next=6;break}return r.next=5,n.changeConfig(o,i);case 5:o=r.sent;case 6:return v(null==o,"pluginize(config,factoryConfig): factoryConfig.changeConfig returns null but should return the modified config.","factoryConfig.changeConfig.isNull"),v("object"!==e(o),"pluginize(config,factoryConfig): factoryConfig.changeConfig returns a "+("undefined"==typeof entry?"undefined":e(entry))+"but should return an object.","factoryConfig.changeConfig.wrongType"),v(Array.isArray(o),"pluginize(config,factoryConfig): factoryConfig.changeConfig returns an Array but should return an object.","factoryConfig.changeConfig.wrongTypeArray"),o.debug&&k("development"),o.name||(o.name="PluginizeAsync"),i.log("Starting Pluginize."),r.next=14,t(m,i);case 14:a=h(n.configs),r.prev=15,a.s();case 17:if((u=a.n()).done){r.next=23;break}return c=u.value,r.next=21,t(c,i);case 21:r.next=17;break;case 23:r.next=28;break;case 25:r.prev=25,r.t0=r.catch(15),a.e(r.t0);case 28:return r.prev=28,a.f(),r.finish(28);case 31:return r.next=33,t(o,i);case 33:l=h(i.plugins),r.prev=34,l.s();case 36:if((s=l.n()).done){r.next=45;break}return v(null==(f=s.value),"error in Pluginize(config): hook preInitPlugin - a listener returns null but should  return an object (the modified config)","config.changeConfig.returnNull"),v(Array.isArray(f)||"object"!==e(f),"error in Pluginize(config): hook preInitPlugin - a listener should return an object (the modified config) but returns a "+e(f),"config.changeConfig.wrongType"),i.log('- call hook "initPlugin" of plugin '+f.name),r.next=43,i.hooks.initPlugin.promise(f,i);case 43:r.next=36;break;case 45:r.next=50;break;case 47:r.prev=47,r.t1=r.catch(34),l.e(r.t1);case 50:return r.prev=50,l.f(),r.finish(50);case 53:return i.log('- call hook "pluginsInitialized"'),r.next=56,i.hooks.pluginsInitialized.promise(i);case 56:return r.next=58,i.hooks.return.promise(i);case 58:if(!i.return){r.next=62;break}return r.abrupt("return",i[i.return]);case 62:return r.abrupt("return",i);case 63:case"end":return r.stop()}}),r,null,[[15,25,28,31],[34,47,50,53]])})));return function(){return o.apply(this,arguments)}}()}function O(n){function t(n,r){if(r.log('- Add plugin "'+n.name+'"'),v(null==(n=r.hooks.preInitPlugin.call(n,r)||n),"Error: Plugin is null","conf.isNull"),v(!n.name,"Plugin ".concat(JSON.stringify(n),' has no name. Please define a name by adding an attribute name:"pluginname" to your plugin.'),"plugin.noName"),v("function"==typeof n,"Plugin ".concat(n.name," is a function, but should be a configuration object. Did you forget calling it? (eg: PluginName())"),"plugin.isFunction"),v("object"!==e(n)||Array.isArray(n),"Plugin ".concat(n.name," should be a configuration of type object, but is typeof ").concat(e(n),"."),"plugin.wrongType"),r.plugins.push(n),n.init){v("function"!=typeof n.init,'Error in plugin "'.concat(n.name,'": config.init must be a function but is a ').concat(e(n.init)),"config.init.wrongtype"),r.log("- Execute init() function of plugin ".concat(n.name));var o=n.init(n,r);if(o&&!o._context&&"object"==e(o)&&!Array.isArray(o)){var i,a=h(Object.keys(o)||{});try{for(a.s();!(i=a.n()).done;){var u=i.value;r.log("- add "+u+" to global context."),r[u]=o[u]}}catch(n){a.e(n)}finally{a.f()}}}n.hooks&&n.hooks.initPlugin&&r.hooks.initPlugin.tap(n.name,n.hooks.initPlugin),v(n.plugins&&!Array.isArray(n.plugins),'Error in plugin "'.concat(n.name,'": config.plugin must be an array but is an ').concat(e(n.plugins)),"config.plugin.wrongtype");var c,l=h(n.plugins||[]);try{for(l.s();!(c=l.n()).done;){t(c.value,r)}}catch(n){l.e(n)}finally{l.f()}return r}return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o={plugins:[],config:r,_context:!0,addPlugin:t,hooks:{return:new x(["context"]),preInitPlugin:new C(["config","context"]),pluginsInitialized:new x(["context"]),initPlugin:new x(["plugin","context"])},log:function(){var n;r.debug&&(n=console).log.apply(n,arguments)}};n.changeConfig&&(r=n.changeConfig(r,o)),v(null==r,"pluginize(config,factoryConfig): factoryConfig.changeConfig returns null but should return the modified config.","factoryConfig.changeConfig.isNull"),v("object"!==e(r),"pluginize(config,factoryConfig): factoryConfig.changeConfig returns a "+("undefined"==typeof entry?"undefined":e(entry))+"but should return an object.","factoryConfig.changeConfig.wrongType"),v(Array.isArray(r),"pluginize(config,factoryConfig): factoryConfig.changeConfig returns an Array but should return an object.","factoryConfig.changeConfig.wrongTypeArray"),r.debug&&k("development"),r.name||(r.name="Pluginize"),o.log("Starting Pluginize."),t(m,o);var i,a=h(n.configs);try{for(a.s();!(i=a.n()).done;){var u=i.value;t(u,o)}}catch(n){a.e(n)}finally{a.f()}t(r,o);var c,l=h(o.plugins);try{for(l.s();!(c=l.n()).done;){var s=c.value;v(null==s,"error in Pluginize(config): hook preInitPlugin - a listener returns null but should  return an object (the modified config)","config.changeConfig.returnNull"),v(Array.isArray(s)||"object"!==e(s),"error in Pluginize(config): hook preInitPlugin - a listener should return an object (the modified config) but returns a "+e(s),"config.changeConfig.wrongType"),o.log('- call hook "initPlugin" of plugin '+s.name),o.hooks.initPlugin.call(s,o)}}catch(n){l.e(n)}finally{l.f()}return o.log('- call hook "pluginsInitialized"'),o.hooks.pluginsInitialized.call(o),o.hooks.return.call(o),o.return?o[o.return]:o}}var S=["resolve","init"];return n.AsyncBreakableHook=z,n.AsyncHook=P,n.AsyncWaterfallHook=A,n.SyncBreakableHook=j,n.SyncHook=x,n.SyncWaterfallHook=C,n.pluginize=function(){var n,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=Object.assign({configs:[],plugins:[]},r);v(!Array.isArray(o.plugins),"pluginize(config,factoryConfig): factoryConfig.plugins should be null or an Array but is typeof "+e(o.plugins),"factoryConfig.plugins.wrongType");var i=Array.isArray(t)?t:[t];i=i.map((function(n){return n.name=n.name||"pluginize(config)",n})),(n=o.configs).push.apply(n,g(i));var a,u=h(o.plugins);try{var c=function(){var n=a.value;v("object"!=e(n)||Array.isArray(n),"pluginize(config,factoryConfig): A plugin in factoryConfig.plugins is typeof "+e(n)+" but should be an object","factoryConfig.plugins.plugin.wrongType"),v(Object.keys(n).some((function(n){return!S.includes(n)})),"pluginize(config,factoryConfig): A plugin in factoryConfig.plugins has an invalid key. only ".concat(S.join(",")," is allowed."),"factoryConfig.plugins.plugin.wrongkey"),v(Object.keys(n).some((function(e){return"function"!=typeof n[e]})),"pluginize(config,factoryConfig): A plugin in factoryConfig.plugins has an invalid type. It must be typeof function.","factoryConfig.plugins.plugin.wrongkeytype"),n.init&&n.init(o)};for(u.s();!(a=u.n()).done;)c()}catch(n){u.e(n)}finally{u.f()}var l,s=I(o),f=O(o),p={apply:s,applySync:f},y=h(o.plugins);try{for(y.s();!(l=y.n()).done;){var d=l.value;d.resolve&&(p=d.resolve(p)||p)}}catch(n){y.e(n)}finally{y.f()}return p},n}({}),pluginize=pluginizeWrapper.pluginize;
//# sourceMappingURL=pluginize-es5.js.map
